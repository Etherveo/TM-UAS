<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Karakter - Tiga Benang Kehidupan</title>
    
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* ==================== 1. VARIABLES & RESET ==================== */
        :root {
            /* Theme Colors (Will be updated by JS) */
            --theme-primary: #D4AF37;
            --theme-bg: #F9F3E0;
            --theme-text: #1e1e24;
            
            --header-h: 70px;
            --radius: 20px;
            /* Standard padding for cards */
            --card-padding: 24px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--theme-bg);
            color: var(--theme-text);
            overflow-x: hidden; /* Prevent horizontal scroll during transitions */
            transition: background-color 0.6s ease-in-out;
            min-height: 100vh;
            width: 100%;
        }

        /* Scrollbar hide */
        ::-webkit-scrollbar { width: 0px; background: transparent; }

        /* ==================== 2. HEADER UI (Shared) ==================== */
        header {
            position: fixed; top: 0; left: 0; width: 100%; height: var(--header-h);
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 2rem; z-index: 100;
            background: rgba(255,255,255,0.1); backdrop-filter: blur(8px);
        }

        .nav-left { display: flex; gap: 0.8rem; }
        .nav-btn {
            background: rgba(255,255,255,0.7); border: none; padding: 8px 16px;
            border-radius: 50px; font-weight: 600; cursor: pointer;
            transition: 0.3s; color: #1e1e24; text-decoration: none;
            display: inline-flex; align-items: center; font-size: 0.85rem;
        }
        .nav-btn:hover { transform: translateY(-2px); background: white; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }

        /* Theme Switchers */
        .theme-switcher-desktop { display: flex; gap: 10px; }
        .palette-btn { width: 28px; height: 28px; border-radius: 50%; cursor: pointer; border: 2px solid rgba(255,255,255,0.5); transition: 0.3s; }
        .palette-btn:hover { transform: scale(1.15); }
        .p-gold { background: #D4AF37; } .p-white { background: #FFFFFF; } .p-red { background: #C0392B; }

        .theme-switcher-mobile { display: none; position: relative; }
        .current-palette { width: 32px; height: 32px; border-radius: 50%; border: 2px solid white; cursor: pointer; }
        .mobile-dropdown {
            position: absolute; top: 40px; right: 0; background: white; padding: 8px;
            border-radius: 12px; display: flex; flex-direction: column; gap: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1); opacity: 0; visibility: hidden;
            transform: translateY(-10px); transition: 0.3s;
        }
        .mobile-dropdown.active { opacity: 1; visibility: visible; transform: translateY(0); }

        /* ==================== 3. ANIMATION UTILS ==================== */
        /* Class ini ditambahkan JS saat ganti tema untuk efek "kabur" */
        .anim-exit {
            opacity: 0 !important;
            transform: scale(0.95) translateY(-20px) !important;
            filter: blur(4px);
        }
        
        /* Target animasi default state */
        .anim-target {
            transition: all 0.5s cubic-bezier(0.4, 0.0, 0.2, 1);
            transform: scale(1) translateY(0);
            opacity: 1;
            filter: blur(0);
        }

        /* ==================== 4. SHARED COMPONENTS ==================== */
        /* Info Panel (Stats Box) */
        .info-panel-content {
            background: rgba(255,255,255,0.6);
            backdrop-filter: blur(10px);
            border-radius: var(--radius);
            padding: var(--card-padding);
            height: 100%;
            display: flex; flex-direction: column; gap: 1rem;
            box-shadow: 0 8px 24px rgba(0,0,0,0.05);
            border: 1px solid rgba(255,255,255,0.4);
            overflow-y: auto;
        }
        
        .char-header-text { border-bottom: 2px solid var(--theme-primary); padding-bottom: 8px; margin-bottom: 8px; }
        .char-name-text { font-size: 1.8rem; font-weight: 900; line-height: 1; text-transform: uppercase; color: var(--theme-primary); }
        .char-class-text { font-size: 0.85rem; color: #666; font-style: italic; }
        .desc-box-text { font-size: 0.85rem; line-height: 1.5; color: #444; }

        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 0.8rem; }
        .stat-row { display: flex; justify-content: space-between; border-bottom: 1px solid rgba(0,0,0,0.05); padding: 4px 0; }
        .stat-label { font-weight: 600; color: #888; }
        .stat-val { font-weight: 700; color: #1e1e24; }

        /* Collection/Elements Items */
        .col-item {
            width: 60px; height: 60px; background: white; border-radius: 16px;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: 0.3s; position: relative;
        }
        .col-item:hover { transform: translateY(-3px); box-shadow: 0 8px 16px rgba(var(--theme-primary), 0.3); }
        .col-item i { font-size: 1.4rem; color: var(--theme-primary); }
        .col-item img { width: 100%; height: 100%; object-fit: cover; border-radius: 16px; }

        /* Image Styling */
        .char-img-style {
            width: auto;
            height: auto;
            /* Kunci agar tidak scroll di desktop */
            max-height: 75vh; 
            max-width: 100%;
            object-fit: contain;
            filter: drop-shadow(0 12px 24px rgba(0,0,0,0.15));
        }

        /* ==================== 5. DESKTOP LAYOUTS (GRID SYSTEMS) ==================== */
        main {
            padding-top: var(--header-h);
            min-height: 100vh;
            display: flex; justify-content: center; align-items: center;
            padding-bottom: 1rem;
        }

        .desktop-layout {
            display: grid;
            width: 90%; max-width: 1200px;
            height: 80vh; /* Fixed height area for desktop */
            gap: 20px;
        }

        /* --- A. Layout GOLD & WHITE (Mirrored) --- */
        /* Default Gold: Info | Image | Elements */
        body[data-theme="gold"] .desktop-layout {
            grid-template-columns: 320px 1fr 80px;
            grid-template-areas: "info image elements";
            align-items: center;
        }
        /* White: Elements | Image | Info (Glass overlap) */
        body[data-theme="white"] .desktop-layout {
            grid-template-columns: 80px 1fr 320px;
            grid-template-areas: "elements image info";
            align-items: center;
        }
        /* Placement */
        .area-info { grid-area: info; height: 100%; }
        .area-image { grid-area: image; display: flex; justify-content: center; align-items: center; height: 100%; }
        .area-elements { grid-area: elements; display: flex; flex-direction: column; gap: 16px; justify-content: center; align-self: center; /* Center vertically */ }

        /* Style adjustment for White overlap */
        body[data-theme="white"] .info-panel-content {
            background: rgba(255,255,255,0.3);
            border-left: 1px solid rgba(255,255,255,0.5);
            border-radius: 0 var(--radius) var(--radius) 0;
            margin-left: -40px; /* Overlap effect */
            z-index: 2;
        }

        /* --- B. Layout RED (New 2x2 Grid) --- */
        body[data-theme="red"] .desktop-layout {
            grid-template-columns: 320px 1fr;
            grid-template-rows: auto 1fr;
            grid-template-areas: 
                "elements name"
                "info image";
            align-items: start;
            gap: 30px;
        }
        
        body[data-theme="red"] .area-elements {
            grid-area: elements; flex-direction: row; justify-content: flex-start;
        }
        body[data-theme="red"] .area-name-red {
            grid-area: name; align-self: center;
        }
        /* Red Name Style */
        .red-desktop-name { font-size: 4rem; font-weight: 900; text-transform: uppercase; color: var(--c-red); line-height: 1; }

        body[data-theme="red"] .area-info {
            grid-area: info; height: auto; align-self: start;
        }
        /* Hide header in info panel for red desktop, since it's above */
        body[data-theme="red"] .area-info .char-header-text { display: none; }
        
        body[data-theme="red"] .area-image {
            grid-area: image; align-items: start; justify-content: flex-end;
        }
        body[data-theme="red"] .char-img-style { max-height: 65vh; }


        /* ==================== 6. MOBILE LAYOUT (THE FLIPPER) ==================== */
        .mobile-layout-wrapper { display: none; } /* Hidden on desktop */

        @media (max-width: 768px) {
            .theme-switcher-desktop { display: none; }
            .theme-switcher-mobile { display: block; }
            .desktop-layout { display: none; } /* Hide desktop grid */
            
            main { align-items: flex-start; height: auto; padding-bottom: 0; }

            .mobile-layout-wrapper {
                display: block;
                width: 100%;
                padding: 1rem;
                /* Mendekatkan konten ke navbar */
                margin-top: -10px; 
            }

            /* Flipper Container */
            .flip-container {
                perspective: 1000px;
                width: 100%;
                /* Tinggi dinamis berdasarkan konten, tapi dikasih min-height biar gak gepeng */
                min-height: 450px; 
                position: relative;
            }

            .flipper {
                transition: 0.8s cubic-bezier(0.4, 0.0, 0.2, 1);
                transform-style: preserve-3d;
                position: relative;
                width: 100%; height: 100%;
            }
            
            /* State untuk membalik kartu */
            .flip-container.flipped .flipper { transform: rotateY(180deg); }

            .flip-face {
                backface-visibility: hidden;
                position: absolute; top: 0; left: 0;
                width: 100%; height: auto; min-height: 100%; /* Ensure full height coverage */
                border-radius: var(--radius);
                background: rgba(255,255,255,0.5);
                backdrop-filter: blur(10px);
                box-shadow: 0 10px 30px rgba(0,0,0,0.1);
                padding: var(--card-padding);
                /* FIX ASIMETRIS: Pastikan box-sizing benar */
                box-sizing: border-box; 
            }

            /* --- FRONT FACE: Elements + Image (Row) --- */
            .front {
                z-index: 2;
                display: flex;
                align-items: center;
                gap: 15px;
            }
            
            /* Urutan: Elements kiri, Gambar kanan */
            .mob-elements-col { display: flex; flex-direction: column; gap: 12px; }
            .mob-image-col { flex: 1; display: flex; justify-content: center; }
            .mob-image-col img { 
                max-width: 100%; height: auto; 
                max-height: 350px; /* Batasi tinggi di mobile */
                object-fit: contain; filter: drop-shadow(0 5px 15px rgba(0,0,0,0.1));
            }

            /* Khusus Si Putih Mobile: Gambar Kiri, Elemen Kanan (reverse row) */
            body[data-theme="white"] .front { flex-direction: row-reverse; }

            /* --- BACK FACE: Stats --- */
            .back {
                transform: rotateY(180deg);
                background: white; /* Solid background for readability */
                display: flex; flex-direction: column;
                /* Ensure padding is uniform (Fix ga_simetris.jpg) */
                padding: 24px !important; 
            }
            /* Sembunyikan header nama di belakang karena double */
            .back .char-header-text { display: none; }
        }
    </style>
</head>
<body data-theme="gold">

    <!-- === HEADER === -->
    <header>
        <div class="nav-left">
            <a href="index.html" class="nav-btn"><i class="fas fa-arrow-left me-2"></i> Back</a>
            <a href="#" class="nav-btn">Karawo</a>
            <a href="#" class="nav-btn">Kitorang</a>
        </div>

        <!-- Desktop Theme Switcher -->
        <div class="theme-switcher-desktop">
            <div class="palette-btn p-gold" onclick="switchTheme('gold')"></div>
            <div class="palette-btn p-white" onclick="switchTheme('white')"></div>
            <div class="palette-btn p-red" onclick="switchTheme('red')"></div>
        </div>

        <!-- Mobile Theme Switcher -->
        <div class="theme-switcher-mobile">
            <div class="current-palette p-gold" id="mobPaletteBtn" onclick="toggleMobMenu()"></div>
            <div class="mobile-dropdown" id="mobDropdown">
                <div class="palette-btn p-gold" onclick="switchTheme('gold')"></div>
                <div class="palette-btn p-white" onclick="switchTheme('white')"></div>
                <div class="palette-btn p-red" onclick="switchTheme('red')"></div>
            </div>
        </div>
    </header>

    <main>
        <!-- ================= DESKTOP LAYOUT CONTAINER ================= -->
        <!-- Struktur Grid ini berubah fungsi area-nya tergantung CSS data-theme -->
        <div class="desktop-layout anim-target" id="desktopContainer">
            
            <!-- Area: INFO PANEL -->
            <section class="area-info">
                <div class="info-panel-content" id="desktopInfoContent">
                    <!-- Content populated by JS -->
                </div>
            </section>

            <!-- Area: IMAGE -->
            <section class="area-image">
                <img src="" alt="Character" class="char-img-style" id="desktopCharImg">
            </section>

            <!-- Area: ELEMENTS (Collection) -->
            <section class="area-elements" id="desktopElements">
                <!-- Content populated by JS -->
            </section>

            <!-- Area: NAME (Khusus Red Desktop) -->
            <section class="area-name-red desktop-only" style="display: none;" id="redNameArea">
                <h1 class="red-desktop-name">SI MERAH</h1>
            </section>
        </div>


        <!-- ================= MOBILE LAYOUT CONTAINER (Flipper) ================= -->
        <div class="mobile-layout-wrapper anim-target" id="mobileContainer">
            <div class="flip-container" id="mobFlipper" onclick="this.classList.toggle('flipped')">
                <div class="flipper">
                    <!-- Front Face: Elements & Image Row -->
                    <div class="flip-face front">
                        <div class="mob-elements-col" id="mobElements">
                            <!-- Populated by JS -->
                        </div>
                        <div class="mob-image-col">
                            <img src="" alt="Character" id="mobCharImg">
                        </div>
                        <!-- Hint -->
                        <div style="position:absolute; bottom:10px; left:50%; transform:translateX(-50%); font-size:0.7rem; opacity:0.6;"><i class="fas fa-sync"></i> Tap to flip</div>
                    </div>
                    
                    <!-- Back Face: Stats Info -->
                    <div class="flip-face back" id="mobInfoContent">
                         <!-- Populated by JS (Cloned from desktop info) -->
                    </div>
                </div>
            </div>
        </div>
    </main>


    <!-- TEMPLATES UNTUK ELEMEN KOLEKSI (Biar gampang di-inject JS) -->
    <template id="tmpl-elements">
        <div class="col-item" onclick="alert('Fitur Bio/Weapon Popup belum aktif')">
            <img src="" class="col-img-face" style="border-radius: 14px;">
        </div>
        <div class="col-item" onclick="alert('Fitur Weapon 1 Popup belum aktif')">
            <i class="icon-w1"></i>
        </div>
        <div class="col-item" onclick="alert('Fitur Weapon 2 Popup belum aktif')">
            <i class="icon-w2"></i>
        </div>
    </template>


    <script>
        // === DATA KARAKTER ===
        const charData = {
            gold: {
                theme: 'gold', color: '#D4AF37', bg: '#F9F3E0', img: 'si_emas.jpg',
                name: "SI EMAS", class: "The Visionary Planner",
                desc: "Perencana ulung yang melihat masa depan dalam selembar kertas kosong. Imajinasinya adalah cetak biru realitas.",
                stats: { lvl: 50, exp: 15000, hp: 4000, mp: 1200, acc: "98%", agi: 60, crit: "30%", ras: "Mummy", age: "3000+" },
                icons: ['fa-pencil-alt', 'fa-scroll']
            },
            white: {
                theme: 'white', color: '#333', bg: '#dde1e7', img: 'si_putih.jpg', // Pake warna teks gelap untuk putih
                name: "SI PUTIH", class: "Perfectionist Soul",
                desc: "Presisi adalah segalanya. Tidak ada jahitan yang meleset. Hidup adalah tentang kesempurnaan absolut.",
                stats: { lvl: 55, exp: 18000, hp: 3200, mp: 900, acc: "100%", agi: 85, crit: "70%", ras: "Mummy", age: "2800+" },
                icons: ['fa-syringe', 'fa-slash'] // Ganti icon jarum/silet
            },
            red: {
                theme: 'red', color: '#C0392B', bg: '#EADBD9', img: 'si_merah.jpg',
                name: "SI MERAH", class: "Brave Heart",
                desc: "Keberanian membara dalam serat benang merah. Bertarung bukan untuk menang, tapi untuk melindungi ikatan.",
                stats: { lvl: 60, exp: 22000, hp: 5500, mp: 600, acc: "80%", agi: 90, crit: "50%", ras: "Mummy", age: "2500+" },
                icons: ['fa-heartbeat', 'fa-wave-square']
            }
        };

        let activeTheme = 'gold';
        const body = document.body;
        const desktopContainer = document.getElementById('desktopContainer');
        const mobileContainer = document.getElementById('mobileContainer');

        // Init
        window.onload = () => { loadContent('gold'); };

        // === CORE SWITCHING LOGIC ===
        function switchTheme(newTheme) {
            if (activeTheme === newTheme) { toggleMobMenu(false); return; }

            // 1. Trigger EXIT Animation
            desktopContainer.classList.add('anim-exit');
            mobileContainer.classList.add('anim-exit');

            // 2. Wait for animation, then swap data & layout styles
            setTimeout(() => {
                // Change Theme Variables & Body Data
                body.setAttribute('data-theme', newTheme);
                document.documentElement.style.setProperty('--theme-primary', charData[newTheme].color);
                document.documentElement.style.setProperty('--theme-bg', charData[newTheme].bg);
                
                // Update Mobile Toggle Button Color
                document.getElementById('mobPaletteBtn').className = `current-palette p-${newTheme}`;
                toggleMobMenu(false); // Close menu if open

                // Handle Special Red Desktop layout visibility
                const redNameArea = document.getElementById('redNameArea');
                if(newTheme === 'red') {
                    redNameArea.style.display = 'block';
                } else {
                    redNameArea.style.display = 'none';
                }

                // Load New Data into DOM
                loadContent(newTheme);

                // Reset Mobile Flipper State
                document.getElementById('mobFlipper').classList.remove('flipped');

                // 3. Trigger ENTER Animation (Remove exit class)
                setTimeout(() => {
                    desktopContainer.classList.remove('anim-exit');
                    mobileContainer.classList.remove('anim-exit');
                }, 100); // Short delay to ensure DOM updated

                activeTheme = newTheme;
            }, 500); // Match CSS transition time
        }


        // === CONTENT LOADING FUNCTION ===
        function loadContent(theme) {
            const data = charData[theme];

            // A. Generate INFO PANEL HTML Structure
            const infoHtml = `
                <div class="char-header-text">
                    <h1 class="char-name-text" style="color: ${data.color}">${data.name}</h1>
                    <span class="char-class-text">${data.class}</span>
                </div>
                <div class="desc-box-text">${data.desc}</div>
                <div class="stats-grid">
                    <div class="stat-row"><span class="stat-label">Level</span><span class="stat-val">${data.stats.lvl}</span></div>
                    <div class="stat-row"><span class="stat-label">Exp</span><span class="stat-val">${data.stats.exp}</span></div>
                    <div class="stat-row"><span class="stat-label">HP</span><span class="stat-val">${data.stats.hp}</span></div>
                    <div class="stat-row"><span class="stat-label">MP</span><span class="stat-val">${data.stats.mp}</span></div>
                    <div class="stat-row"><span class="stat-label">Acc</span><span class="stat-val">${data.stats.acc}</span></div>
                    <div class="stat-row"><span class="stat-label">Agi</span><span class="stat-val">${data.stats.agi}</span></div>
                    <div class="stat-row"><span class="stat-label">Crit</span><span class="stat-val">${data.stats.crit}</span></div>
                    <div class="stat-row"><span class="stat-label">Ras</span><span class="stat-val">${data.stats.ras}</span></div>
                    <div class="stat-row"><span class="stat-label">Umur</span><span class="stat-val">${data.stats.age}</span></div>
                </div>
            `;

            // B. Generate ELEMENTS HTML Structure (from Template)
            const tmpl = document.getElementById('tmpl-elements');
            const elementsFragment = tmpl.content.cloneNode(true);
            // Inject data into template clone
            elementsFragment.querySelector('.col-img-face').src = data.img;
            elementsFragment.querySelector('.icon-w1').className = `fas ${data.icons[0]}`;
            elementsFragment.querySelector('.icon-w2').className = `fas ${data.icons[1]}`;


            // C. INJECT TO DESKTOP
            document.getElementById('desktopInfoContent').innerHTML = infoHtml;
            document.getElementById('desktopCharImg').src = data.img;
            // Clear and append elements
            const deskElemContainer = document.getElementById('desktopElements');
            deskElemContainer.innerHTML = ''; 
            deskElemContainer.appendChild(elementsFragment.cloneNode(true));

            // D. INJECT TO MOBILE
            document.getElementById('mobInfoContent').innerHTML = infoHtml;
            document.getElementById('mobCharImg').src = data.img;
            // Clear and append elements
            const mobElemContainer = document.getElementById('mobElements');
            mobElemContainer.innerHTML = '';
            mobElemContainer.appendChild(elementsFragment.cloneNode(true));
        }

        // Mobile Menu Toggle
        function toggleMobMenu(forceState) {
            const menu = document.getElementById('mobDropdown');
            if (typeof forceState !== 'undefined') {
                menu.classList.toggle('active', forceState);
            } else {
                menu.classList.toggle('active');
            }
        }

    </script>
</body>
</html>